<mat-toolbar>
  <button mat-button>ROOM</button>
  <span class="spacer"></span>
  <button *ngIf="!(user$ | async)" mat-raised-button color="primary" (click)="login()">ログイン</button>
  <button *ngIf="user$ | async as user" mat-button color="primary" (click)="logout(user.uid)">ログアウト</button>
</mat-toolbar>

<div class="room" [class.dark]="!(lightStatus$ | async)">
  <div class="room__light" (click)="toggleLight(this.lightStatus)">
    <img src="assets/images/light.png" alt="">
  </div>

  <div class="user" *ngFor="let user of users$ | async" [style.left]="user.leftPosition"
       cdkDrag
       cdkDragBoundary=".room"
       cdkDragLockAxis="x">
    <ul>
      <li *ngFor="let message of messages[user.uid]">
        {{message}}
      </li>
    </ul>
    <img src="assets/images/chars/{{user.avatarId}}.png" alt="">
  </div>
  <div class="room__floor"></div>
</div>

<h2>メッセージ一覧</h2>
<ul>
  <li *ngFor="let message of messages$ | async">
    {{message.body}}
  </li>
</ul>

<form *ngIf="user$ | async as user" [formGroup]="form" (ngSubmit)="sendMessage(user.uid)">
  <mat-form-field>
    <input formControlName="body" type="text" matInput autofocus autocomplete="off"/>
  </mat-form-field>
  <button mat-icon-button [disabled]="form.invalid">
    <mat-icon>send</mat-icon>
  </button>
</form>

